<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="使用托管服务（如 Rollbar）向基于 Django 的 Web 应用程序添加监视服务。">
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="使用 Rollbar 监控 Django 项目" />
<meta name="twitter:image" content="https://www.fullstackpython.com/img/180202-monitor-django/header.jpg" />
<meta name="twitter:site" content="@fullstackpython" />
<meta name="twitter:creator" content="@mattmakai" />
<meta property="og:url" content="https://www.fullstackpython.com/blog/monitor-django-projects-web-apps-rollbar.html" />
<meta property="og:title" content="使用 Rollbar 监控 Django 项目" />
<meta property="og:description" content="使用托管服务（如 Rollbar）向基于 Django 的 Web 应用程序添加监视服务。 Great post on fullstackpython.com!" />
<meta property="og:image" content="https://www.fullstackpython.com/img/180202-monitor-django/header.jpg" />
<link rel="canonical" href="https://www.fullstackpython.com/blog/monitor-django-projects-web-apps-rollbar.html" />
<title>使用 Rollbar 监控 Django 项目 - Full Stack Python</title> <style>hr,img{border:0}*,:after,:before{box-sizing:border-box}html{-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;font-size:18px;background:#fefefe}body{margin:0;font:18px Georgia,serif;line-height:1.4;color:#222;padding:0}img{vertical-align:middle}hr{height:0;box-sizing:content-box;margin:21px 0;border-top:1px solid #eee}h1,h2,h3,h4,h5,h6{font-family:"Helvetica Neue",sans-serif;font-weight:500;line-height:1.1;color:#000}h1,h2,h3{margin:32px 0 6px}h1{font-size:40px}h2{font-size:28px}h3{font-size:22px}h4,h5,h6{margin:11px 0;font-size:18px}p{margin:0 0 12px}ol,ul{margin:0 0 10px}code,pre{font:"Courier New",monospace;border-radius:4px;background-color:#f4f9ff;font-size:12px}code{padding:2px 4px;white-space:nowrap}pre{white-space:pre-wrap;display:block;padding:10px;margin:0 0 11px;line-height:1.4;word-break:break-all;word-wrap:break-word;border:1px solid #ccc}.cn{padding:0 15px 0 15px;margin-right:auto;margin-left:auto}.cn:before,.cn:after{display:table;content:" "}.cn:after{clear:both}.row:before,.row:after{display:table;content:" "}.row:after{clear:both}.c2,.c3,.c4,.c5,.c6,.c7,.c8,.c9,.c10,.c11,.c12{position:relative;min-height:1px;padding:0 15px 0 15px}a{background:transparent;text-decoration:none;border-bottom:1px dotted;color:#444}a:hover{text-decoration:none;color:#000}.ft{padding:0 0 24px;float:right}.sns{font-family:"Helvetica Neue",sans-serif}.sps{font-size:14px}.hd{margin:20px 0 15px 0}.hd>a{border-bottom:none}img.hdr{vertical-align:middle;border:none;height:52px;width:52px;padding:1px}.hdt a,.hdt a:hover{font:72px "Helvetica Neue",sans-serif;font-weight:normal;letter-spacing:.03em;vertical-align:middle;margin-left:5px;color:#000;text-decoration:none;border-bottom:none;line-height:.9em}.bk{margin:0 7px 0 7px}img.nob{border:none}.pn{margin:0 0 21px;background:#fff;border:1px solid transparent;border-radius:4px;border-color:#22b24c}.pnb{padding:15px}.pnb:before,.pnb:after{display:table;content:" "}.pnb:after{clear:both}.pn>.lg{margin-bottom:0}.pn>.lg .lgi{border-width:1px 0;font:14px 'Helvetica Neue',sans-serif;padding:5px 0 5px 10px}.pn>.lg .lgi:first-child{border-top-right-radius:0;border-top-left-radius:0}.pn>.lg .lgi:last-child{border-bottom:0;background-color:#22b24c;color:#fff}.pnh+.lg .lgi:first-child{border-top-width:0}.pnh{padding:10px 15px;border-bottom:1px solid transparent;border-top-right-radius:3px;border-top-left-radius:3px;color:#468847;background-color:#22b24c;border-color:#22b24c}.pn>.pnh>h3{margin:5px 0 0 0;color:#fff}.pn>.pnh>h3>a{color:#fff}.pn>.lg a.lgi.sbc{padding-left:27px}.pn>.lg a.lgi.sbc2{padding-left:35px}#sb{margin-top:40px}.lg{padding-left:0;margin-bottom:20px}.lgi{position:relative;display:block;padding:10px 15px;margin-bottom:-1px;background-color:#fff;border:1px solid #ddd}.lgi:first-child{border-top-right-radius:4px;border-top-left-radius:4px}.lgi:last-child{margin-bottom:0;border-bottom-right-radius:4px;border-bottom-left-radius:4px}a.lgi{color:#333}a.lgi:hover,a.lgi:focus{background:#ddd}a.lgi.active{z-index:2;background:#444;color:#fff;border:1px solid #222}.btn-full{width:100%;box-shadow:1px 2px 1px #222;padding-bottom:4px}p.under-btn{text-align:left;margin-top:20px}p.banner{font-weight:500;line-height:1.1;color:#fff;font-size:22px;margin:14px 0 18px 0}th{text-align:left;font-family:"Helvetica Neue",sans-serif}td{padding-right:20px}blockquote{border-left:4px solid #aaa;padding-left:10px;font-family:"Helvetica Neue"}.well{min-height:20px;padding:19px;margin:0 0 20px;background-color:#f5f5f5;border:1px solid #e3e3e3;border-radius:4px;box-shadow:inset 0 1px 1px rgba(0,0,0,0.05)}.see-also{margin-top:20px;background:#22B24C;color:#eee;font-family:"Helvetica Neue",sans-serif}.see-also a{color: #fff}.highlight{background:#ffff00}.form-control{display:block;width:100%;height:39px;padding:8px 12px;font-size:14px;color:#777;vertical-align:middle;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075);transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;box-shadow:inset 0 1px 1px rgba(0,0,0,0.075),0 0 8px rgba(102,175,233,0.6)}.btn{display:inline-block;padding:8px 12px;margin-bottom:0;font-size:15px;line-height:1.4;text-align:center;white-space:nowrap;vertical-align:middle;cursor:pointer;border:1px solid transparent;border-radius:4px;color:#fff;background-color:#22b24c;border-color:#22b24c}.btn:active,.btn.active{background-image:none;outline:0;box-shadow:inset 0 3px 5px rgba(0,0,0,0.125)}img.rnd{border:1px solid #ccc;border-radius:5px}.shot{border-radius:5px}.outl{border: 1px solid #ccc}.talk{margin-bottom:22px}@media (min-width:750px){.cn{width:730px}}@media (min-width:768px){.cn{width:750px}#full-toc{display:block}#mobile-toc{display:none}.c3,.c4,.c6,.c8,.c9,.c12{float:left}.c12{width:100%} .c9{width:75%} .c6{width:50%} .c8{width:66.66666666666666%} .c4{width:33.33333333333333%} .c3{width:25%} .co1{margin-left:8.333333333333332%} .select-next{min-height:300px}}@media (min-width:940px){.cn{width:920px}}@media (min-width:1140px){.cn{width:1120px}}.row{margin-right:-15px;margin-left:-15px} @media (max-width:767px){#full-toc{display:none} .hd{padding:8px 0 10px; margin:0} .hdt a,.hdt a:hover{font-size:34px} h1{font-size:28px} h2{font-size:24px} img.hdr{height:26px;width:26px} pre{font-size:60%}} @media (min-width:1140px){.select-next{min-height:220px}}</style><link rel="shortcut icon" href="/img/fsp-fav.png">
</head>
<body>
<div class="cn">
<div class="row"><div class="c12"><div class="hd"><a href="https://fullstackpython.qiwihui.com/"><img src="/img/logos/f.png" class="hdr" alt="Full Stack Python logo"></a><span class="hdt"> <a href="https://fullstackpython.qiwihui.com/">全栈 Python</a></span></div><div class="sns">
<a href="/table-of-contents.html">全部主题</a> <span class="bk">|</span>
<a href="/blog.html">博客</a> <span class="bk">|</span>
<a href="/email.html">邮件订阅</a> <span class="bk">|</span>
<a href="https://twitter.com/fullstackpython">@fullstackpython</a> <span class="bk">|</span>
<a href="https://www.facebook.com/fullstackpython">Facebook</a> <span class="bk">|</span>
<a href="/change-log.html">更新日志</a> <span class="bk">|</span>
<a href="https://github.com/qiwihui/fullstackpython.com">源码</a> 
</div></div></div><div class="row">
 <div class="c12">
  <h1 style="font-size: 36px;">使用 Rollbar 监控 Django 项目</h1>
  <div style="font-size:12px;color:#666;margin:0 0 10px">
     Post updated by <a href="/about-author.html">Matt Makai</a> on 
     May 20, 2018. Originally posted
     on February 02, 2018.
  </div>
 </div>
</div>
<div class="row">
  <div class="c9">
   <p>One fast way to scan for exceptions and errors in your
<a href="/django.html">Django</a> web application projects is to add a few lines of 
code to include a hosted <a href="/monitoring.html">monitoring</a> tool.</p>
<p>In this tutorial we will learn to add the
<a href="https://rollbar.com">Rollbar monitoring service</a>
to a web app to visualize any issues produced by our web app.
This tutorial will use <a href="/django.html">Django</a> as the 
<a href="/web-frameworks.html">web framework</a> to build the web application but
there are also tutorials for 
the <a href="/blog/hosted-monitoring-flask-web-apps.html">Flask</a> and 
<a href="/blog/monitor-python-web-applications.html">Bottle</a> frameworks as well.
You can also check out a list of other hosted and open source tools on the 
<a href="/monitoring.html">monitoring</a> page.</p>
<h2>Our Tools</h2>
<p><a href="/python-2-or-3.html">Python 3</a> is strongly recommended for this tutorial
because Python 2 will no longer be supported starting January 1, 2020.
<a href="https://www.python.org/downloads/release/python-364/">Python 3.6.4</a> to 
was used to build this tutorial. We will also use the following 
<a href="/application-dependencies.html">application dependencies</a> to build
our application:</p>
<ul>
<li><a href="/django.html">Django</a> web framework, 
  <a href="https://docs.djangoproject.com/en/2.0/">version 2.0.4</a></li>
<li><a href="https://rollbar.com/docs/notifier/pyrollbar/">rollbar</a> monitoring 
  instrumentation library,
  <a href="https://github.com/rollbar/pyrollbar/tree/v0.13.18">version 0.13.18</a>,
  to report exceptions and errors</li>
<li><a href="https://pip.pypa.io/en/stable/">pip</a> and 
  <a href="https://virtualenv.pypa.io/en/latest/">virtualenv</a>, which come installed 
  with Python 3, to install and isolate these Django and Rollbar libraries 
  from your other applications</li>
<li>A <a href="https://rollbar.com/">free Rollbar account</a> where we will send error
  data and view it when it is captured</li>
</ul>
<p>If you need help getting your 
<a href="/development-environments.html">development environment</a> configured
before running this code, take a look at
<a href="/blog/python-3-django-gunicorn-ubuntu-1604-xenial-xerus.html">this guide for setting up Python 3 and Django on Ubuntu 16.04 LTS</a>.</p>
<p>All code in this blog post is available open source on GitHub under the 
MIT license within the
<a href="https://github.com/fullstackpython/blog-code-examples">monitor-python-django-apps directory of the blog-code-examples repository</a>. 
Use and modify the code however you like for your own applications.</p>
<h2>Installing Dependencies</h2>
<p>Start the project by creating a new 
<a href="/virtual-environments-virtualenvs-venvs.html">virtual environment</a> 
using the following command. I recommend keeping a separate directory 
such as <code>~/venvs/</code> so that you always know where all your virtualenvs are 
located.</p>
<div class="highlight"><pre><span></span>python3 -m venv monitordjango
</pre></div>


<p>Activate the virtualenv with the <code>activate</code> shell script:</p>
<div class="highlight"><pre><span></span><span class="nb">source</span> monitordjango/bin/activate
</pre></div>


<p>The command prompt will change after activating the virtualenv:</p>
<p><img src="/img/180202-monitor-django/activate-virtualenv.png" width="100%" class="shot rnd outl" alt="Activate the virtualenv on the command line."></p>
<p>Remember that you need to activate your virtualenv in every new terminal 
window where you want to use the virtualenv to run the project.</p>
<p>We can now install the <a href="https://pypi.org/project/Django/2.0.4">Django</a> 
and <a href="https://pypi.org/project/rollbar">Rollbar</a> packages into the 
activated, empty virtualenv.</p>
<div class="highlight"><pre><span></span>pip install django==2.0.4 rollbar==0.13.18
</pre></div>


<p>Look for output like the following to confirm the 
dependencies installed correctly.</p>
<div class="highlight"><pre><span></span>Collecting certifi&gt;=2017.4.17 (from requests&gt;=0.12.1-&gt;rollbar==0.13.18)
  Downloading certifi-2018.1.18-py2.py3-none-any.whl (151kB)
    100% |████████████████████████████████| 153kB 767kB/s 
Collecting urllib3&lt;1.23,&gt;=1.21.1 (from requests&gt;=0.12.1-&gt;rollbar==0.13.18)
  Using cached urllib3-1.22-py2.py3-none-any.whl
Collecting chardet&lt;3.1.0,&gt;=3.0.2 (from requests&gt;=0.12.1-&gt;rollbar==0.13.18)
  Using cached chardet-3.0.4-py2.py3-none-any.whl
Collecting idna&lt;2.7,&gt;=2.5 (from requests&gt;=0.12.1-&gt;rollbar==0.13.18)
  Using cached idna-2.6-py2.py3-none-any.whl
Installing collected packages: pytz, django, certifi, urllib3, chardet, idna, requests, six, rollbar
  Running setup.py install for rollbar ... done
Successfully installed certifi-2018.1.18 chardet-3.0.4 django-2.0.4 idna-2.6 pytz-2018.3 requests-2.18.4 rollbar-0.13.18 six-1.11.0 urllib3-1.22
</pre></div>


<p>We have our dependencies ready to go so now we can write the code for
our Django project.</p>
<h2>Our Django Web App</h2>
<p><a href="/django.html">Django</a> makes it easy to generate the boilerplate code 
for new projects and apps using the <code>django-admin.py</code> commands. Go to the 
directory where you typically store your coding projects. For example, on 
my Mac I use <code>/Users/matt/devel/py/</code>. Then run the following command to 
start a Django project named <code>djmonitor</code>:</p>
<div class="highlight"><pre><span></span>django-admin.py startproject djmonitor
</pre></div>


<p>The command will create a directory named <code>djmonitor</code> with several
subdirectories that you should be familiar with when you've previously 
worked with Django.</p>
<p>Change directories into the new project.</p>
<div class="highlight"><pre><span></span>cd djmonitor
</pre></div>


<p>Start a new Django app for our example code.</p>
<div class="highlight"><pre><span></span>python manage.py startapp billions
</pre></div>


<p>Django will create a new folder named <code>billions</code> for our project.
Let's make sure our Django URLS work properly before before we write 
the code for the app.</p>
<p>Now open <code>djmonitor/djmonitor/urls.py</code> and add the highlighted lines so that URLs
with the path <code>/billions/</code> will be routed to the app we are working on.</p>
<div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; (comments section)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="highlight"><span class="o"></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span></span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
<span class="highlight"><span class="o"></span>    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;billions/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;billions.urls&#39;</span><span class="p">)),</span></span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>Save <code>djmonitor/djmonitor/urls.py</code> and open <code>djmonitor/djmonitor/settings.py</code>.
Add the <code>billions</code> app to <code>settings.py</code> by inserting the highlighted line,
which will become line number 40 after insertion:</p>
<div class="highlight"><pre><span></span><span class="c1"># Application definition</span>

<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span> 
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
<span class="highlight"><span class="o"></span>    <span class="s1">&#39;billions&#39;</span><span class="p">,</span></span>
<span class="p">]</span>
</pre></div>


<p>Save and close <code>settings.py</code>.</p>
<p><strong>Reminder</strong>: make sure you change the default <code>DEBUG</code> and <code>SECRET_KEY</code> 
values in <code>settings.py</code> before you deploy any code to production. Secure 
your app properly with the information from the
<a href="https://docs.djangoproject.com/en/2.0/howto/deployment/checklist/">Django production deployment checklist</a> 
so that you do not add your project to the list of hacked applications
on the web.</p>
<p>Next change into the <code>djmonitor/billions</code> directory. Create a new file named 
<code>urls.py</code> that will be specific to the routes for the <code>billions</code> app within 
the <code>djmonitor</code> project.</p>
<p>Add the following lines to the currently-blank <code>djmonitor/billions/urls.py</code> 
file.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span>                                                                                                                              
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span> 
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?P&lt;slug&gt;[\wa-z-]+)&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">they</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;they&quot;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>Save <code>djmonitor/billions/urls.py</code>. One more file before we can test that
our simple Django app works. Open <code>djmonitor/billions/views.py</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">PermissionDenied</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>


<span class="k">def</span> <span class="nf">they</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">slug</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">slug</span> <span class="ow">and</span> <span class="n">slug</span> <span class="o">==</span> <span class="s2">&quot;are&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;billions.html&#39;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PermissionDenied</span><span class="p">(</span><span class="s2">&quot;Hmm, can&#39;t find what you&#39;re looking for.&quot;</span><span class="p">)</span>
</pre></div>


<p>Create a directory for your template files named <code>templates</code> under
the <code>djmonitor/billions</code> app directory.</p>
<div class="highlight"><pre><span></span>mkdir templates
</pre></div>


<p>Within <code>templates</code> create a new file named <code>billions.html</code> that contains
the following <a href="/django-templates.html">Django template</a> markup.</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>They... are BILLIONS!<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;http://store.steampowered.com/app/644930/They_Are_Billions/&quot;</span><span class="p">&gt;</span>They Are Billions<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://media.giphy.com/media/2jUHXTGhGo156/giphy.gif&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>


<p>Alright, all of our files are in place so we can test the application.
Within the base directory of your project run the Django development
server:</p>
<div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>


<p>The Django development server will start up with no issues other than an 
unapplied migrations warning.</p>
<div class="highlight"><pre><span></span>(monitordjango) $ python manage.py runserver
Performing system checks...

System check identified no issues (0 silenced).

You have 14 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run &#39;python manage.py migrate&#39; to apply them.

April 08, 2018 - 19:06:44
Django version 2.0.4, using settings &#39;djmonitor.settings&#39;
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
</pre></div>


<p>Only the <code>/billions/</code> route will successfully hit our <code>billions</code> app. Try
to access "http://localhost:8000/billions/are/". We should see our template
render with the gif:</p>
<p><img src="/img/180202-monitor-django/localhost-dev-server.jpg" width="100%" class="shot rnd outl" alt="Testing local development server at /billions/are/."></p>
<p>Cool, our application successfully rendered a super-simple HTML page 
with a GIF of one of my favorite computer games. What if we try another
path under <code>/billions/</code> such as "http://localhost:8000/billions/arenot/"?</p>
<p><img src="/img/180202-monitor-django/arenot-403-forbidden.png" width="100%" class="shot rnd outl" alt="403 Forbidden error with any path under /billions/ other than /billions/are/."></p>
<p>Our 403 Forbidden is raised, which is what we expected based on our code.
That is a somewhat contrived block of code but let's see how we can
catch and report this type of error without changing our <code>views.py</code>
code at all. This approach will be much easier on us when modifying an
existing application than having to refactor the code to report on
these types of errors, if we even know where they exist.</p>
<h2>Monitoring with Rollbar</h2>
<p>Go to the <a href="https://rollbar.com/">Rollbar homepage in your browser</a> 
to add their tool to our Django app.</p>
<p><img src="/img/180202-monitor-django/rollbar-home.jpg" width="100%" class="shot rnd outl" alt="rollbar.com in Chrome."></p>
<p>Click the "Sign Up" button in the upper right-hand corner. Enter your 
email address, a username and the password you want on the sign up page.</p>
<p><img src="/img/180202-monitor-django/sign-up-rollbar.jpg" width="100%" class="shot rnd outl" alt="Sign up for Rollbar."></p>
<p>After the sign up page you will see the onboarding flow where you can
enter a project name and select a programming language. For the project
name type in "Full Stack Python" (or whatever project name you are
working on) then select that you are monitoring a Python-based application.</p>
<p><img src="/img/180202-monitor-django/create-project.jpg" width="100%" class="shot rnd outl" alt="Create a project named 'Full Stack Python' and select Python for programming language."></p>
<p>Press the "Continue" button at the bottom to move along. The next
screen shows us a few instructions on how to add monitoring.</p>
<p><img src="/img/180202-monitor-django/configure-project.jpg" width="100%" class="shot rnd outl" alt="Configure project using your server-side access token."></p>
<p>Let's change our Django project code to let Rollbar collect and aggregate the
errors that pop up in our application. </p>
<p>Re-open <code>djmonitor/djmonitor/settings.py</code> and look for the <code>MIDDLEWARE</code>
list. Add <code>rollbar.contrib.django.middleware.RollbarNotifierMiddleware</code>
as the last item:</p>
<div class="highlight"><pre><span></span><span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span> 
    <span class="s1">&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class="p">,</span>
<span class="highlight"><span class="o"></span>    <span class="s1">&#39;rollbar.contrib.django.middleware.RollbarNotifierMiddleware&#39;</span><span class="p">,</span></span>
<span class="p">]</span>
</pre></div>


<p>Do not close <code>settings.py</code> just yet. Next add the following lines 
to the bottom of the file. Change the <code>access_token</code> value to your
Rollbar server side access token and <code>root</code> to the directory where
you are developing your project.</p>
<div class="highlight"><pre><span></span>ROLLBAR = {
    &#39;access_token&#39;: &#39;access token from dashboard&#39;,
    &#39;environment&#39;: &#39;development&#39; if DEBUG else &#39;production&#39;,
    &#39;branch&#39;: &#39;master&#39;,
    &#39;root&#39;: &#39;/Users/matt/devel/py/blog-code-examples/monitor-django-apps/djmonitor&#39;,
    &#39;patch_debugview&#39;: False,
}
</pre></div>


<p>If you are uncertain about what your secret token is, it can be found on 
the Rollbar onboarding screen or "Settings" -&gt; "Access Tokens" within 
<a href="https://rollbar.com">rollbar.com</a>.</p>
<p>Note that I typically store all my environment variables in a <code>.env</code> </p>
<p>We can test that Rollbar is working as we run our application. Run it
now using the development server.</p>
<div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>


<p>Back in your web browser press the "Done! Go to Dashboard" button.</p>
<p>If an event hasn't been reported yet we'll see a waiting screen like this
one:</p>
<p><img src="/img/180202-monitor-django/waiting-for-events.jpg" width="100%" class="shot rnd outl" alt="Waiting for events data on the dashboard."></p>
<p>Make sure your Django development still server is running and try to go to 
"http://localhost:8000/billions/arenot/". A 403 error is immediately reported
on the dashboard:</p>
<p><img src="/img/180202-monitor-django/forbidden-exception.jpg" width="100%" class="shot rnd outl" alt="403 Forbidden exceptions on the Rollbar dashboard screen."></p>
<p>We even get an email with the error (which can also be turned off if you
don't want emails for every error):</p>
<p><img src="/img/180202-monitor-django/email-report.jpg" width="100%" class="shot rnd outl" alt="Email report on the errors in your Django application."></p>
<p>Alright we now have monitoring and error reporting all configured for our
Django application!</p>
<h2>What now?</h2>
<p>We learned to catch issues in our Django project using Rollbar and view the
errors in Rollbar's interface. Next try out Rollbar's more advanced monitoring
features such as:</p>
<ul>
<li><a href="https://rollbar.com/docs/person-tracking/">sorting errors by user</a></li>
<li><a href="https://rollbar.com/docs/custom-grouping/">configuring rules on group errors</a></li>
<li><a href="https://rollbar.com/docs/deploy-tracking/">debugging deployment issues</a></li>
</ul>
<p>There is plenty more to learn about in the areas of 
<a href="/web-development.html">web development</a> and 
<a href="/deployments.html">deployments</a> so keep learning by reading 
about <a href="/web-frameworks.html">web frameworks</a>. You can also learn more 
about integrating Rollbar with Python applications via 
<a href="https://rollbar.com/docs/notifier/pyrollbar/">their Python documentation</a>.</p>
<p>Questions? Let me know via 
<a href="https://github.com/mattmakai/fullstackpython.com/issues">a GitHub issue ticket on the Full Stack Python repository</a>, 
on Twitter 
<a href="https://twitter.com/fullstackpython">@fullstackpython</a>
or <a href="https://twitter.com/mattmakai">@mattmakai</a>.</p>
<p>Do you see a typo, syntax issue or wording that's confusing in this blog 
post? Fork
<a href="https://github.com/mattmakai/fullstackpython.com/blob/master/content/posts/180202-monitor-django-web-apps.markdown">this page's source on GitHub</a>
and submit a pull request with a fix or 
<a href="https://github.com/mattmakai/fullstackpython.com/issues">file an issue ticket on GitHub</a>.</p>
   <hr>
<div id="mc_embed_signup">
<form action="//mattmakai.us2.list-manage.com/subscribe/post?u=b7e774f0c4f05dcebbfee183d&amp;id=b22335388d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
 <div id="mc_embed_signup_scroll">
  <h4>Sign up for a monthly email with Full Stack Python tutorials. No spam ever.</h4>
  <div class="row">
   <div class="c9">
    <input type="email" value="" name="EMAIL" class="email form-control" id="mce-EMAIL" placeholder="email address" required>
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_b7e774f0c4f05dcebbfee183d_b22335388d" tabindex="-1" value=""></div>
   </div>
   <div class="c3">
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="btn btn-success" style="font-family: 'Helvetica Neue'; margin-bottom:6px"></div>
   </div>
  </div>
 </div>
</form>
</div>  </div>
  <div class="c3">
<div class="pn">
 <div class="pnh">
  <h3>Learn more</h3>
 </div>
 <img src="/img/180202-monitor-django/header.jpg" alt="Django 和 Rollbar logos，版权归各自所有者所有。" width="100%"> 
 <div class="lg">
<a href="/django.html" class="lgi">Django</a>
<a href="/web-frameworks.html" class="lgi">Web Frameworks</a>
<a href="/monitoring.html" class="lgi">Monitoring</a>
<a href="/rollbar.html" class="lgi">Rollbar</a>
<a href="/deployment.html" class="lgi">Deployment</a>
<a href="/wsgi-servers.html" class="lgi">WSGI Servers</a>
<a href="/green-unicorn-gunicorn.html" class="lgi">Green Unicorn (Gunicorn)</a>
<a href="https://rollbar.com" class="lgi">Rollbar <svg width="20" height="12" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1408 928v320q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h704q14 0 23 9t9 23v64q0 14-9 23t-23 9h-704q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113v-320q0-14 9-23t23-9h64q14 0 23 9t9 23zm384-864v512q0 26-19 45t-45 19-45-19l-176-176-652 652q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l652-652-176-176q-19-19-19-45t19-45 45-19h512q26 0 45 19t19 45z"/></svg></a>  <a href="/table-of-contents.html" class="lgi">...or view all topics.</a>
 </div>
</div><div class="pn">
 <div class="pnh"><h3>Sponsored By</h3></div>
 <div class="pnb">
<a href="https://rollbar.com/"><img src="/img/logos/rbw.jpg" alt="Rollbar logo" width="100%" style="padding:12px 0 18px"></a>
<p class="sps">Fix errors in your Python code before your users see them by <a href="https://rollbar.com/">monitoring with Rollbar</a>.</p> </div>
</div>  </div>
</div>
<hr></div> 
<div style="margin: 0 0 12px;background-color: #22B24C;">
 <div class="cn">
  <p class="banner sns">
   <a href="https://training.talkpython.fm/courses/explore_ansible/introduction-to-ansible-with-python" style="color: #fff">Learn to deploy and configure servers with Ansible in my latest video course</a>!
  </p>
 </div>
</div>
<div class="container">
    <div class="footer pull-right" style="text-align:right; font-size:85%;">
        This site is based on <a href="https://github.com/mattmakai">Matt Makai</a>'s project <a href="https://github.com/mattmakai/fullstackpython.com">Full Stack Python</a>, thanks for his excellent work!
    </div>
</div>
<div class="container">
    <div class="footer pull-right" style="text-align:right; font-size:85%;">
        <p>此网站由 <a href="https://github.com/qiwihui">@qiwihui</a> 维护。
          若发现错误或想贡献，请访问： <a href="https://github.com/qiwihui/fullstackpython.com">Github qiwihui/fullstackpython.com 项目</a>
        </p>
    </div>
</div><script async src="https://www.googletagmanager.com/gtag/js?id=UA-46660488-4"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-46660488-4');</script>
</body>
</html>